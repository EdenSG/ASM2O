var QueryLoader=function(){var e="",t="",i="",a=0,o=0,s="",r=function(e){return $.map(e,function(e){return e instanceof Array?$.map(e,arguments.callee):e})};return{images:[],scripts:[],selectorPreload:"",init:function(e){var t=this;return this.ops={},$.extend(this.ops,{images:[],scripts:[],imagePrefix:"",scriptPrefix:"",elem:"body"},e),this.selectorPreload=this.ops.elem,$.merge(this.scripts,this.ops.scripts),$.each(this.ops.images,function(e,i){t.images.push(t.ops.imagePrefix+i)}),"MSIE 6.0,6.0"==navigator.userAgent.match(/MSIE (\d+(?:\.\d+)+(?:b\d*)?)/)?!1:("body"==this.selectorPreload?(this.spawnLoader(),this.getImages(this.selectorPreload),this.createPreloading()):$(document).ready(function(){this.spawnLoader(),this.getImages(this.selectorPreload),this.createPreloading()}),s=setTimeout("QueryLoader.ieLoadFix()",function(){t.ieLoadFixTime()}),void 0)},ieLoadFix:function(){var e=navigator.userAgent.match(/MSIE (\d+(?:\.\d+)+(?:b\d*)?)/);if(e&&e[0].match("MSIE"))for(;100>100/a*o;)this.loadedCallback()},loadedCallback:function(){o+=1,this.animateLoader()},getImages:function(e){var t=this;$(e).find("*:not(script)").each(function(){var e="";if("none"!=$(this).css("background-image"))var e=$(this).css("background-image");else if("undefined"!=typeof $(this).attr("src")&&"img"==$(this).attr("tagName").toLowerCase())var e=$(this).attr("src");e=e.replace('url("',""),e=e.replace("url(",""),e=e.replace('")',""),e=e.replace(")",""),e.length>0&&t.images.push(e)})},createPreloading:function(){i=$("<div></div>").appendTo(this.selectorPreload),$(i).css({height:"0px",width:"0px",overflow:"hidden"});var e=this.images.length+r(this.scripts).length;a=e;for(var t=this,o=0;o<this.images.length;o++)$("<img></img>").attr("src",this.images[o]).unbind("load").bind("load",function(){t.loadedCallback()}).appendTo($(i));var s=this.scripts;!function(){if(null!==s){for(var e=s.length,i=arguments.callee,a=s[e-1],o=e,r=function(){t.loadedCallback(),o-=1,0==o&&i()},n=0;e-1>n;n++)s[n].match(/^http/)||(s[n]=t.ops.scriptPrefix+s[n]),$.getScript(s[n],r);"string"==typeof a?(a.match(/^http/)||(a=t.ops.scriptPrefix+a),s=null,$.getScript(a,function(){t.loadedCallback()})):(s=a,o-=1)}}()},spawnLoader:function(){if("body"==this.selectorPreload)var i=$(window).height(),a=$(window).width(),o="fixed",s=0,r=0;else var i=$(this.selectorPreload).outerHeight(),a=$(this.selectorPreload).outerWidth(),o="absolute",s=$(this.selectorPreload).offset().left,r=$(this.selectorPreload).offset().top;e=$("<div></div>").appendTo($(this.selectorPreload)),$(e).addClass("QOverlay"),$(e).css({position:o,top:r,left:s,width:a+"px",height:i+"px"}),t=$("<div></div>").appendTo($(e)),$(t).addClass("QLoader"),$(t).css({position:"relative",top:"50%",width:"0%"})},animateLoader:function(){var e=100/a*o,i=this;e>99?$(t).stop().animate({width:e+"%"},500,"linear",function(){i.doneLoad()}):$(t).stop().animate({width:e+"%"},500,"linear",function(){})},doneLoad:function(){if(clearTimeout(s),"body"==this.selectorPreload)var a=$(window).height();else var a=$(this.selectorPreload).outerHeight();var o=this.ops.onComplete;this.ops.onLoad&&this.ops.onLoad(),$(t).animate({height:a+"px",top:0},500,"linear",function(){$(e).fadeOut(800),$(i).remove(),o&&o()})}}}();
var QueryLoader=function(){var a="",b="",c="",d=0,e=0,g="",h=function(a){return $.map(a,function(a){return a instanceof Array?$.map(a,arguments.callee):a})};return{images:[],scripts:[],selectorPreload:"",init:function(a){var b=this;return this.ops={},$.extend(this.ops,{images:[],scripts:[],imagePrefix:"",scriptPrefix:"",elem:"body"},a),this.selectorPreload=this.ops.elem,$.merge(this.scripts,this.ops.scripts),$.each(this.ops.images,function(a,c){b.images.push(b.ops.imagePrefix+c)}),"MSIE 6.0,6.0"==navigator.userAgent.match(/MSIE (\d+(?:\.\d+)+(?:b\d*)?)/)?!1:("body"==this.selectorPreload?(this.spawnLoader(),this.getImages(this.selectorPreload),this.createPreloading()):$(document).ready(function(){this.spawnLoader(),this.getImages(this.selectorPreload),this.createPreloading()}),g=setTimeout("QueryLoader.ieLoadFix()",function(){b.ieLoadFixTime()}),void 0)},ieLoadFix:function(){var a=navigator.userAgent.match(/MSIE (\d+(?:\.\d+)+(?:b\d*)?)/);if(a&&a[0].match("MSIE"))for(;100>100/d*e;)this.loadedCallback()},loadedCallback:function(){e+=1,this.animateLoader()},getImages:function(a){var b=this;$(a).find("*:not(script)").each(function(){var a="";if("none"!=$(this).css("background-image"))var a=$(this).css("background-image");else if("undefined"!=typeof $(this).attr("src")&&"img"==$(this).attr("tagName").toLowerCase())var a=$(this).attr("src");a=a.replace('url("',""),a=a.replace("url(",""),a=a.replace('")',""),a=a.replace(")",""),a.length>0&&b.images.push(a)})},createPreloading:function(){c=$("<div></div>").appendTo(this.selectorPreload),$(c).css({height:"0px",width:"0px",overflow:"hidden"});var a=this.images.length+h(this.scripts).length;d=a;for(var b=this,e=0;e<this.images.length;e++)$("<img></img>").attr("src",this.images[e]).unbind("load").bind("load",function(){b.loadedCallback()}).appendTo($(c));var f=this.scripts;!function(){if(null!==f){for(var a=f.length,c=arguments.callee,d=f[a-1],e=a,g=function(){b.loadedCallback(),e-=1,0==e&&c()},h=0;a-1>h;h++)f[h].match(/^http/)||(f[h]=b.ops.scriptPrefix+f[h]),$.getScript(f[h],g);"string"==typeof d?(d.match(/^http/)||(d=b.ops.scriptPrefix+d),f=null,$.getScript(d,function(){b.loadedCallback()})):(f=d,e-=1)}}()},spawnLoader:function(){if("body"==this.selectorPreload)var c=$(window).height(),d=$(window).width(),e="fixed",f=0,g=0;else var c=$(this.selectorPreload).outerHeight(),d=$(this.selectorPreload).outerWidth(),e="absolute",f=$(this.selectorPreload).offset().left,g=$(this.selectorPreload).offset().top;a=$("<div></div>").appendTo($(this.selectorPreload)),$(a).addClass("QOverlay"),$(a).css({position:e,top:g,left:f,width:d+"px",height:c+"px"}),b=$("<div></div>").appendTo($(a)),$(b).addClass("QLoader"),$(b).css({position:"relative",top:"50%",width:"0%"})},animateLoader:function(){var a=100/d*e,c=this;a>99?$(b).stop().animate({width:a+"%"},500,"linear",function(){c.doneLoad()}):$(b).stop().animate({width:a+"%"},500,"linear",function(){})},doneLoad:function(){if(clearTimeout(g),"body"==this.selectorPreload)var d=$(window).height();else var d=$(this.selectorPreload).outerHeight();var e=this.ops.onComplete;this.ops.onLoad&&this.ops.onLoad(),$(b).animate({height:d+"px",top:0},500,"linear",function(){$(a).fadeOut(800),$(c).remove(),e&&e()})}}}();